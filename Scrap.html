<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kombucha & Weight Management: An Infographic</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fdf6e3;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .flowchart-arrow {
            position: relative;
            width: 100%;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .flowchart-arrow::before {
            content: '';
            position: absolute;
            width: 2px;
            height: 100%;
            background-color: #ff8c42;
        }
        .flowchart-arrow::after {
            content: '▼';
            color: #ff8c42;
            font-size: 1.5rem;
            position: absolute;
            bottom: -10px;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #e55934;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .prose h3 { margin-top: 1em; margin-bottom: 0.5em; font-weight: bold; font-size: 1.25rem; color: #9f4a25; }
        .prose ul { list-style-type: disc; margin-left: 1.5em; margin-bottom: 1em; }
        .prose p { margin-bottom: 1em; }
    </style>
</head>
<body class="text-gray-800">

    <div id="explanation-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4">
        <div class="bg-white rounded-lg shadow-2xl max-w-2xl w-full p-6 relative max-h-[80vh] overflow-y-auto">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            <h2 id="modal-title" class="text-2xl font-bold text-[#9f4a25] mb-4"></h2>
            <div id="modal-content" class="text-gray-700 prose">
                <div class="flex justify-center items-center h-40">
                    <div class="loader"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-[#e55934] to-[#9f4a25]">Kombucha & Weight Management</h1>
            <p class="text-lg md:text-xl mt-4 text-[#9f4a25]">A Scientific Look at How Gut Health and Fermented Tea Influence Metabolism</p>
        </header>

        <main class="space-y-12">
            
            <section id="intro" class="text-center bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-3xl font-bold text-[#e55934] mb-4">Beyond Calories: The Gut's Role in Weight</h2>
                <p class="text-lg max-w-4xl mx-auto mb-6">Modern science shows that weight management is more complex than just "calories in, calories out." Your gut microbiome, a community of trillions of microbes, acts as a metabolic control center, influencing inflammation, insulin sensitivity, and how your body stores fat.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-[#9f4a25]">
                    <div class="bg-orange-50 p-6 rounded-lg">
                        <p class="text-4xl font-bold">100x</p>
                        <p class="mt-2">The genetic material in your gut microbiome is ~100 times larger than your own genome.</p>
                    </div>
                    <div class="bg-orange-50 p-6 rounded-lg">
                        <p class="text-4xl font-bold">~10:1</p>
                        <p class="mt-2">Microbial cells may outnumber human cells in the body by a factor of ten to one.</p>
                    </div>
                    <div class="bg-orange-50 p-6 rounded-lg">
                        <p class="text-4xl font-bold">Central Regulator</p>
                        <p class="mt-2">The gut microbiome is now considered a functional "organ" influencing whole-body metabolism.</p>
                    </div>
                </div>
            </section>

            <section id="dysbiosis">
                 <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center text-[#e55934] mb-2 flex items-center justify-center gap-4">The "Obesity" Microbiome Profile 
                    <p class="text-center max-w-3xl mx-auto mb-8">An imbalanced gut, or "dysbiosis," is a hallmark of obesity. This involves a loss of microbial diversity and a shift away from beneficial bacteria towards those that promote inflammation and may be more efficient at harvesting energy from food.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="chart-container">
                            <canvas id="bacterialShiftChart"></canvas>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-[#9f4a25] mb-4">Key Microbial Shifts in Obesity</h3>
                            <ul class="space-y-3">
                                <li class="flex items-start">
                                    <span class="text-red-500 text-2xl mr-3">▼</span>
                                    <div><strong class="text-[#e55934]">Loss of Diversity:</strong> A less diverse microbiome is less resilient and is consistently linked to obesity and metabolic disease.</div>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-red-500 text-2xl mr-3">▼</span>
                                    <div><strong class="text-[#e55934]">Depleted Butyrate Producers:</strong> Reduced levels of bacteria like <em class="font-semibold">Faecalibacterium</em> that create anti-inflammatory short-chain fatty acids (SCFAs).</div>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-500 text-2xl mr-3">▲</span>
                                    <div><strong class="text-[#e55934]">Increased Pro-inflammatory Microbes:</strong> An overgrowth of opportunistic microbes that can damage the gut lining and trigger inflammation.</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="mechanism" class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center text-[#e55934] mb-2 flex items-center justify-center gap-4">How Gut Imbalance Drives Weight Gain 
                <p class="text-center max-w-3xl mx-auto mb-8">Gut dysbiosis isn't just a symptom; it actively drives metabolic changes that favor fat storage. This creates a vicious cycle linking poor gut health to weight gain and insulin resistance.</p>
                <div class="flex flex-col items-center">
                    <div class="w-full max-w-md text-center p-4 border-2 border-[#e55934] rounded-lg bg-orange-50">
                        <h3 class="font-bold text-lg text-[#9f4a25]">1. Gut Dysbiosis & Leaky Gut</h3>
                        <p class="text-sm">An imbalanced microbiome weakens the gut wall, allowing bacterial toxins (LPS) to leak into the bloodstream.</p>
                    </div>
                    <div class="flowchart-arrow"></div>
                    <div class="w-full max-w-md text-center p-4 border-2 border-[#ff8c42] rounded-lg bg-orange-100">
                        <h3 class="font-bold text-lg text-[#9f4a25]">2. Chronic Low-Grade Inflammation</h3>
                        <p class="text-sm">Leaked LPS triggers a constant, low-level inflammatory response throughout the body.</p>
                    </div>
                    <div class="flowchart-arrow"></div>
                    <div class="w-full max-w-md text-center p-4 border-2 border-[#ff8c42] rounded-lg bg-orange-100">
                        <h3 class="font-bold text-lg text-[#9f4a25]">3. Insulin Resistance</h3>
                        <p class="text-sm">Inflammation makes cells "resistant" to insulin, the hormone that manages blood sugar.</p>
                    </div>
                     <div class="flowchart-arrow"></div>
                     <div class="w-full max-w-md text-center p-4 border-2 border-red-500 rounded-lg bg-red-50">
                        <h3 class="font-bold text-lg text-red-700">4. Fat Storage Mode</h3>
                        <p class="text-sm">High insulin levels signal the body to store fat (lipogenesis) and actively block the burning of stored fat (lipolysis), creating a metabolic environment that favors weight gain.</p>
                    </div>
                </div>
            </section>

             <section id="kombucha-probiotic">
                <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center text-[#e55934] mb-2">Is Kombucha a Probiotic Powerhouse?</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="chart-container">
                            <canvas id="probioticStandardChart"></canvas>
                        </div>
                        <div>
                            
                        </div>
                    </div>
                </div>
            </section>

    

            <section id="evidence">
                <div class="bg-gradient-to-r from-[#e55934] to-[#9f4a25] rounded-lg shadow-lg p-6 md:p-8 text-white">
                    <h2 class="text-3xl font-bold text-center mb-8">An Evidence-Based Path to Weight Management</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                         <div class="chart-container bg-white/10 p-4 rounded-lg">
                            <canvas id="glycemicResponseChart"></canvas>
                        </div>
                        <div class="text-center">
                            <p class="text-lg text-gray-300">Blunting the Spike</p>
                            <p class="text-2xl font-bold">A 2023 study found that kombucha consumed with a high-carb meal significantly lowered the post-meal Glycemic Index (GI) and Insulin Index (II) compared to a placebo.</p>
                            <p class="mt-4 text-gray-200">Lower insulin spikes mean less hormonal signaling for your body to store fat, helping to break the cycle of insulin resistance.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="practical-swap">
                 <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center text-[#e55934] mb-8">The Simplest Strategy: The Healthy Swap</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center items-center">
                        <div class="p-6 bg-red-50 rounded-lg">
                            <h3 class="text-xl font-bold text-red-700">Typical Soda (12 oz)</h3>
                            <p class="text-4xl font-black text-red-600 my-2">~150</p>
                            <p class="font-semibold text-red-700">Calories</p>
                             <p class="text-4xl font-black text-red-600 my-2">~40g</p>
                            <p class="font-semibold text-red-700">Sugar</p>
                        </div>
                         <div class="text-5xl font-bold text-[#e55934]">vs.</div>
                        <div class="p-6 bg-green-50 rounded-lg">
                            <h3 class="text-xl font-bold text-green-800">Low-Sugar Kombucha (12 oz)</h3>
                            <p class="text-4xl font-black text-green-600 my-2">~45</p>
                            <p class="font-semibold text-green-700">Calories</p>
                            <p class="text-4xl font-black text-green-600 my-2">~4g</p>
                            <p class="font-semibold text-green-700">Sugar</p>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 pt-8 border-t border-gray-300">
            <p class="text-sm text-gray-500">This infographic is for informational purposes only and does not constitute medical advice. Consult with a healthcare professional for personalized guidance on weight management.</p>
            <p class="text-sm text-gray-500 mt-2">Data synthesized from scientific reports on the gut microbiome, weight management, and kombucha. Key sources include Gaggìa et al. (2024) and Harrison & Curtin (2023).</p>
        </footer>

    </div>

    <script>
        const API_MODEL = 'gemini-2.5-flash-preview-05-20';
        const API_KEY = ''; // This will be handled by the execution environment

        async function callGemini(prompt, retries = 3, delay = 1000) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${API_MODEL}:generateContent?key=${API_KEY}`;
            const payload = {
                contents: [{ role: "user", parts: [{ text: prompt }] }]
            };

            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error("Invalid response structure from API");
                    }
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error);
                    if (i === retries - 1) {
                        return "Sorry, I couldn't get a response. Please try again later.";
                    }
                    await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));
                }
            }
        }
        
        function formatGeminiResponse(text) {
             return text
                .replace(/\*\*(.*?)\*\*/g, '<h3>$1</h3>') 
                .replace(/\*/g, '<li>')
                .replace(/(\<\/li\>)?\n/g, '</li>\n')
                .replace(/\<\/li\>\n$/, '</li>')
                .replace(/(\<li\>.*?\<\/li\>)/g, '<ul>$1</ul>')
                .replace(/\<\/ul\>\n\<ul\>/g, '\n')
                .replace(/\n/g, '<br>');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('explanation-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const loaderHtml = '<div class="flex justify-center items-center h-40"><div class="loader"></div></div>';

            document.querySelectorAll('.gemini-explain-btn').forEach(button => {
                button.addEventListener('click', async () => {
                    const topic = button.dataset.topic;
                    modalTitle.textContent = topic;
                    modalContent.innerHTML = loaderHtml;
                    modal.classList.remove('hidden');

                    const prompt = `Explain the concept of "${topic}" in simple, easy-to-understand terms for a layperson interested in weight management. Focus on the key mechanisms and their importance. Use short paragraphs and bullet points for clarity.`;
                    const response = await callGemini(prompt);
                    modalContent.innerHTML = formatGeminiResponse(response);
                });
            });

            function closeModal() {
                modal.classList.add('hidden');
            }
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });

            const generateRecipesBtn = document.getElementById('generate-recipes-btn');
            const ingredientsInput = document.getElementById('ingredients-input');
            const recipeLoader = document.getElementById('recipe-loader');
            const recipeResults = document.getElementById('recipe-results');

            generateRecipesBtn.addEventListener('click', async () => {
                const ingredients = ingredientsInput.value.trim();
                if (!ingredients) {
                    recipeResults.innerHTML = '<p class="text-red-600 text-center">Please enter some ingredients first.</p>';
                    return;
                }

                recipeLoader.style.display = 'flex';
                recipeResults.innerHTML = '';
                generateRecipesBtn.disabled = true;

                const prompt = `As a nutritionist, create 2 simple recipes using the following ingredients: ${ingredients}. The recipes must be high in fiber and prebiotics to support a healthy gut microbiome for weight management. For each recipe, provide a title in bold asterisks, a short 1-sentence description, a list of ingredients, and simple instructions.`;
                const response = await callGemini(prompt);
                
                recipeResults.innerHTML = `<div class="p-4 bg-orange-50 rounded-lg prose max-w-none">${formatGeminiResponse(response)}</div>`;
                recipeLoader.style.display = 'none';
                generateRecipesBtn.disabled = false;
            });
        });


        function wrapText(str, maxWidth) {
            if (str.length <= maxWidth) {
                return str;
            }
            const words = str.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine.length > 0) {
                lines.push(currentLine);
            }
            return lines;
        }

        const tooltipTitleCallback = function(tooltipItems) {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
              return label.join(' ');
            } else {
              return label;
            }
        };

        const chartColors = {
            primary: '#e55934',
            secondary: '#ff8c42',
            accent: '#9f4a25',
            light: '#fdf6e3',
            red: '#ef4444',
            green: '#22c55e'
        };

        const defaultChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        color: chartColors.accent,
                        font: {
                            family: "'Inter', sans-serif"
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    },
                    backgroundColor: chartColors.accent,
                    titleFont: { size: 14, family: "'Inter', sans-serif" },
                    bodyFont: { size: 12, family: "'Inter', sans-serif" },
                }
            },
            scales: {
                y: {
                    ticks: { color: chartColors.primary, font: { family: "'Inter', sans-serif" } },
                    grid: { color: '#fae5be' }
                },
                x: {
                    ticks: { color: chartColors.primary, font: { family: "'Inter', sans-serif" } },
                    grid: { display: false }
                }
            }
        };

        const bacterialShiftCtx = document.getElementById('bacterialShiftChart').getContext('2d');
        new Chart(bacterialShiftCtx, {
            type: 'bar',
            data: {
                labels: ['Microbial Diversity', 'Butyrate Producers', 'Pro-inflammatory Microbes'],
                datasets: [{
                    label: 'Lean Profile',
                    data: [90, 80, 20],
                    backgroundColor: chartColors.green,
                }, {
                    label: 'Obese Profile (Dysbiosis)',
                    data: [40, 30, 75],
                    backgroundColor: chartColors.red,
                }]
            },
            options: { ...defaultChartOptions,
                scales: {
                    y: { ...defaultChartOptions.scales.y,
                        title: { display: true, text: 'Relative Score / Abundance', color: chartColors.accent }
                    },
                    x: { ...defaultChartOptions.scales.x }
                }
            }
        });
        
        const probioticStandardCtx = document.getElementById('probioticStandardChart').getContext('2d');
        new Chart(probioticStandardCtx, {
            type: 'doughnut',
            data: {
                labels: ['Meets Probiotic Standard (>1M CFU/mL)', 'Does NOT Meet Standard'],
                datasets: [{
                    label: 'Commercial Kombuchas Tested',
                    data: [6.3, 93.7],
                    backgroundColor: [
                        chartColors.green,
                        chartColors.red,
                    ],
                    borderColor: chartColors.light,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                           color: chartColors.accent,
                           font: { family: "'Inter', sans-serif" }
                        }
                    },
                    tooltip: {
                         callbacks: {
                            title: tooltipTitleCallback,
                            label: function(context) {
                                let label = context.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed !== null) {
                                    label += context.parsed + '%';
                                }
                                return label;
                            }
                        },
                        backgroundColor: chartColors.accent,
                    },
                    title: {
                        display: true,
                        text: 'Commercial Kombuchas vs. Probiotic Standard',
                        color: chartColors.accent,
                        font: { size: 16 }
                    }
                }
            }
        });

        const glycemicResponseCtx = document.getElementById('glycemicResponseChart').getContext('2d');
        new Chart(glycemicResponseCtx, {
            type: 'bar',
            data: {
                labels: ['Glycemic Index (GI)', 'Insulin Index (II)'],
                datasets: [{
                    label: 'Meal with Placebo',
                    data: [86, 85],
                    backgroundColor: chartColors.red,
                }, {
                    label: 'Meal with Kombucha',
                    data: [68, 70],
                    backgroundColor: chartColors.green,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { 
                        position: 'bottom',
                        labels: { color: '#FFFFFF' }
                    },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback
                        },
                        backgroundColor: '#FFFFFF',
                        titleColor: chartColors.accent,
                        bodyColor: chartColors.accent,
                        borderColor: '#e0e0e0',
                        borderWidth: 1,
                    },
                     title: {
                        display: true,
                        text: 'Post-Meal Response',
                        color: '#FFFFFF',
                        font: { size: 16 }
                    }
                },
                scales: {
                    y: {
                        ticks: { color: '#FFFFFF', font: { family: "'Inter', sans-serif" } },
                        grid: { color: 'rgba(255, 255, 255, 0.2)' },
                    },
                    x: {
                        ticks: { color: '#FFFFFF', font: { family: "'Inter', sans-serif", size: 14 } },
                        grid: { display: false }
                    }
                }
            }
        });
    </script>
</body>
</html>
